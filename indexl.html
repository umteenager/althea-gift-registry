<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Althea's 18th Birthday Gift Registry</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 750px; margin: auto; background-color: #ffffff; padding: 20px; color: #333; }
    h1 { text-align: center; color: #5a5a5a; }
    p.intro { text-align: center; font-size: 1.05em; background-color: #f2f2f2; padding: 15px; border-radius: 10px; margin-bottom: 25px; border: 1px solid #d9d9d9;}
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; background-color: #fff; }
    th { background-color: #e6e6e6; color: #333; }
    .taken { background-color: #d9d9d9; color: #555; }
    a { display: block; margin: 2px 0; color: #333; text-decoration: none; }
    a:hover { text-decoration: underline; }
    button { background-color: #c0c0c0; border: none; padding: 6px 12px; border-radius: 5px; cursor: pointer; color: #000;}
    button:hover { background-color: #a6a6a6; color: white; }
  </style>
</head>
<body>
  <h1>Althea's 18th Birthday Gift Registry</h1>

  <p class="intro">
     Welcome to Althea’s 18th Birthday Gift Registry!  <br><br>
    Thank you so much for celebrating this special milestone with me.<br>
    Here, you’ll find a list of gifts I’ve carefully chosen and would be so happy to receive.<br><br>
    <b>How it works:</b><br>
    1. Click <b>View</b> to see the gift.<br>
    2. Choose a gift you’d like to give.<br>
    3. Click <b>Select</b> and enter your name.<br>
    4. Once selected, the gift will be marked as <b>Taken</b> so others know it’s reserved.<br><br>
    Your thoughtfulness and love mean the world to me. <br>
    Thank you for making my 18th birthday even more memorable! 
  </p>

  <table id="giftTable">
    <thead>
      <tr>
        <th>Gift</th>
        <th>Link(s)</th>
        <th>Status</th>
        <th>Select</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxY9hMRPgLu-jKCo0PwsyeIedPcJbD-2U8tcbNYocc26rkJFpXobIAhfvOuywfLS6WA/exec";

    async function loadGifts() {
      const res = await fetch(SCRIPT_URL);
      const gifts = await res.json();
      const tableBody = document.querySelector("#giftTable tbody");
      tableBody.innerHTML = "";

      gifts.forEach(gift => {
        const row = document.createElement("tr");
        const links = gift.link.split(";").map(l => `<a href="${l.trim()}" target="_blank">View</a>`).join("");

        row.innerHTML = `
          <td>${gift.name}</td>
          <td>${links}</td>
          <td class="status">${gift.status}</td>
          <td>
            <button onclick="selectGift('${gift.name}', this)" ${gift.status === "Taken" ? "disabled" : ""}>
              Select
            </button>
          </td>
        `;

        if (gift.status === "Taken") row.classList.add("taken");
        tableBody.appendChild(row);
      });
    }

    async function selectGift(giftName, btn) {
      const name = prompt("Enter your name to reserve this gift:");
      if (!name) return;

      const response = await fetch(SCRIPT_URL, {
        method: "POST",
        body: JSON.stringify({ gift: giftName, name: name }),
      });

      const result = await response.text();
      if (result === "success") {
        alert("Thank you! Gift reserved.");
        loadGifts();
      } else {
        alert("Sorry, this gift was already taken.");
        loadGifts();
      }
    }

    loadGifts();
    setInterval(loadGifts, 10000);
  </script>
</body>
</html>
